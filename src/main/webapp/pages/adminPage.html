<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/styles_adminPage.css">
    <link rel="stylesheet" href="../css/styles_popup.css">
    <script type="text/javascript" src="../lib/jquery-3.6.0.min.js"></script>
    <title>GoodPlants Admin</title>
</head>
<body>
<div class="container">
    <header>
        <p class="btn-font logo">Admin page</p>
        <p class="header-font logo">goodplants</p>
        <div class="btn btn-font logout" id="logout">log out</div>
    </header>
    <div class="tables_container small-table-font">
        <div id="orders" class="table">
        </div>
        <div id="plants" class="table">
            <button class="show_popup blue_btn" rel="add_popup">Add plant</button>
            <div class="overlay_popup"></div>
            <div class="popup" id="add_popup">
                <div class="object">
                    <form action="" method="">
                        <p>Name</p>
                        <p><input type="text" name="name" id="name_select"></p>
                        <p>Family:</p>
                        <p><input type="text" name="family" id="family_select"></p>
                        <p>Desc: </p>
                        <p><textarea rows="10" cols="45" name="desc" id="desc_select"></textarea></p>
                        <p>Image</p>
                        <p><input type="file" accept="image/*" name="image" id="image_select"></p>
                        <select  id="water_select">
                            <option disabled>WATER</option>
                            <option>every 3-5 days</option>
                            <option>1-2 times  a week</option>
                            <option>every 10-14 days</option>
                            <option>once a month</option>
                        </select>
                        <select id="sun_select">
                            <option disabled>SUN</option>
                            <option>part-shade</option>
                            <option>part-sun</option>
                            <option>part-full</option>
                            <option>full sun</option>
                            <option>full shade</option>
                        </select>
                        <select id="care_select">
                            <option disabled>CARE</option>
                            <option>easy</option>
                            <option>medium</option>
                            <option>hard</option>
                        </select>
                        <select id="toxicity_select">
                            <option disabled>TOXICITY</option>
                            <option>toxic</option>
                            <option>non-toxic</option>
                        </select>
                        <input type="submit" value="Add" id="addBtn">
                    </form>
                </div>
            </div>
        </div>
    </div>
    <footer>
    </footer>
</div>
</body>
</html>

<script>
    function getAllPlants(s) {
        $.get("../filter-servlet",
            {allPlants: "true"},
            function (responseTxt) {
                var plantlist = responseTxt.split("|");
                var plant;
                var plants = "<table><caption>Plants list</caption><tr><th>Plant</th><th>Family</th>" +
                    "<th>Description</th><th>img</th><th>Water</th><th>Care</th><th>Sun</th><th>Toxicity</th></tr>";
                plantlist.forEach(el => {
                    plant = el.split(";");
                    plants += "<tr><th><div contenteditable>" + plant[1] + "</div></th><th><div contenteditable>" +
                        plant[2] + "</div></th><th><div contenteditable class='plant_desc'>" + plant[3] +
                        "</div></th><th>" + plant[4] + "</th><th>" + plant[5] + "</th><th>" + plant[6] + "</th><th>" +
                        plant[7] + "</th><th>" + plant[8] + "</th></tr>";
                });
                plants += "</table>";
                $("#plants").append(plants);
            }
        );
    }

    $(document).ready(function () {
        getAllPlants("allPlants")
        if (localStorage.getItem("adminAuth") != "true") window.location.replace("../index.html");
    });

    var orders = [
        {"id": 1, "name": "Anna", "phone": "+79625180233", "datetime": " 2007-10-23 11:37:55", "plant_id": 1},
        {"id": 2, "name": "Anna1", "phone": "+79625180233", "datetime": " 2007-10-23 11:38:55", "plant_id": 4},
        {"id": 3, "name": "Anna2", "phone": "+79625180233", "datetime": " 2007-10-23 11:39:55", "plant_id": 6},
        {"id": 4, "name": "Anna3", "phone": "+79625180233", "datetime": " 2007-10-23 12:37:55", "plant_id": 7},
        {"id": 5, "name": "Anna4", "phone": "+79625180233", "datetime": " 2007-10-23 13:37:55", "plant_id": 8},
        {"id": 6, "name": "Anna5", "phone": "+79625180233", "datetime": " 2007-10-23 11:31:55", "plant_id": 9},
        {"id": 12, "name": "Anna6", "phone": "+79625180233", "datetime": " 2007-10-23 11:32:55", "plant_id": 10},
        {"id": 13, "name": "Anna7", "phone": "+79625180233", "datetime": " 2007-10-23 11:33:55", "plant_id": 11},
        {"id": 14, "name": "Anna8", "phone": "+79625180233", "datetime": " 2007-10-23 11:34:55", "plant_id": 1},
        {"id": 15, "name": "Anna9", "phone": "+79625180233", "datetime": " 2007-10-24 11:37:55", "plant_id": 1},
        {"id": 16, "name": "Anna10", "phone": "+79625180233", "datetime": " 2007-10-25 11:37:55", "plant_id": 1}
    ];

    addOrdersToTable(orders);

    function addOrdersToTable(items) {
        var orders = "<table><caption>Orders</caption><tr><th>Order №</th><th>Name</th><th>Date</th>" +
            "<th>Phone</th><th>Plant</th></tr>";

        items.forEach(item => {
            orders += "<tr><th>" + item.id + "</th><th>" + item.name + "</th><th>" + item.datetime + "</th><th>" +
                item.phone + "</th><th>" + item.plant_id + "</th></tr>"; //тут будет не айди у растения
        });

        orders += "</table>";
        $("#orders").append(orders);
    }

    var logoutBtn = document.getElementById('logout');

    logoutBtn.addEventListener('click', function () {
        localStorage.setItem("adminAuth", "false");
        window.location.replace("../index.html");
    }, false);

    $('.show_popup').click(function () {
        var popup_id = $('#' + $(this).attr("rel"));
        $(popup_id).show();
        $('.overlay_popup').show();
    })

    $('.overlay_popup').click(function () {
        $('.overlay_popup, .popup').hide();
    });

    $('#image_select').click(function () {
        var fileName = $("#image_select").val().split('/').pop().split('\\').pop();
        console.log(fileName);
    });

</script>